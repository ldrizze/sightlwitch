[gd_scene load_steps=21 format=3 uid="uid://b0tmg25rlvr6e"]

[ext_resource type="Script" path="res://character_script.gd" id="1_15ym8"]
[ext_resource type="Script" path="res://levels-scripts/level_8_script.gd" id="1_ttiok"]
[ext_resource type="SpriteFrames" uid="uid://gtxt1ly4x1kq" path="res://character_anim.tres" id="2_1guxn"]
[ext_resource type="AudioStream" uid="uid://did7rv621lxv1" path="res://sfx/light-switch-81967.mp3" id="3_3qlgd"]
[ext_resource type="TileSet" uid="uid://c4crmo1po74jt" path="res://raw_map_tile_set.tres" id="4_d8f6u"]
[ext_resource type="Texture2D" uid="uid://dodimdsaeofg2" path="res://vendor/1-Bit Platformer Pack/Tiles/Transparent/tile_0097.png" id="5_163c0"]
[ext_resource type="SpriteFrames" uid="uid://d0dbjj6xx7jjl" path="res://door_anim.tres" id="6_gwvjs"]
[ext_resource type="Texture2D" uid="uid://b4fg2kx57xe6l" path="res://switch.png" id="7_hnhjq"]
[ext_resource type="Script" path="res://BackgroundColor.gd" id="8_v4sxp"]
[ext_resource type="Script" path="res://moving_platform.gd" id="9_mb6ax"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_xyr5i"]
size = Vector2(7, 8)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_2boxm"]
size = Vector2(2, 1)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_7tvwx"]
size = Vector2(4.25, 8)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_4lccq"]
size = Vector2(11, 14)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_eh0eq"]
size = Vector2(7, 6)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_pw2v7"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_euvql"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_0jk3o"]
size = Vector2(16, 7)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_2ljfn"]
size = Vector2(20, 369)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_rwov1"]
size = Vector2(20, 369)

[node name="main" type="Node2D"]
script = ExtResource("1_ttiok")

[node name="Camera2D" type="Camera2D" parent="."]
anchor_mode = 0

[node name="CharacterBody2D" type="CharacterBody2D" parent="." node_paths=PackedStringArray("spawn")]
z_index = 1
position = Vector2(53, 235)
collision_mask = 6
script = ExtResource("1_15ym8")
GRAVITY = 9.81
jump_force = 80.0
walk_velocity = 120.0
mass = 15.0
spawn = NodePath("../SpawnMark")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="CharacterBody2D"]
position = Vector2(1, -6)
sprite_frames = ExtResource("2_1guxn")
animation = &"idle"

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterBody2D"]
position = Vector2(-0.75, 2)
shape = SubResource("RectangleShape2D_xyr5i")

[node name="Foot" type="Area2D" parent="CharacterBody2D"]
position = Vector2(0, 20)
collision_layer = 0
collision_mask = 6

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterBody2D/Foot"]
position = Vector2(-0.75, -13.5)
shape = SubResource("RectangleShape2D_2boxm")
debug_color = Color(0.913725, 0.235294, 0.443137, 0.419608)

[node name="Pick" type="Area2D" parent="CharacterBody2D"]
collision_mask = 480

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterBody2D/Pick"]
position = Vector2(3.375, 2)
shape = SubResource("RectangleShape2D_7tvwx")
debug_color = Color(0.92549, 0.152941, 0.572549, 0.419608)

[node name="CollisionShape2D2" type="CollisionShape2D" parent="CharacterBody2D/Pick"]
position = Vector2(-5, 2)
shape = SubResource("RectangleShape2D_7tvwx")
debug_color = Color(0.92549, 0.152941, 0.572549, 0.419608)

[node name="Body" type="Area2D" parent="CharacterBody2D"]
position = Vector2(-2, -4)
collision_mask = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="CharacterBody2D/Body"]
position = Vector2(0.5, 3)
shape = SubResource("RectangleShape2D_4lccq")

[node name="ClickSound" type="AudioStreamPlayer" parent="CharacterBody2D"]
stream = ExtResource("3_3qlgd")
volume_db = -17.0

[node name="RespawnTimer" type="Timer" parent="CharacterBody2D"]
one_shot = true

[node name="SpawnMark" type="Marker2D" parent="."]
position = Vector2(53, 223)

[node name="Map" type="Node" parent="."]

[node name="Terrain" type="TileMap" parent="Map" groups=["terrain"]]
tile_set = ExtResource("4_d8f6u")
format = 2
layer_0/tile_data = PackedInt32Array(1114112, 458752, 4, 1114113, 524288, 4, 1114114, 524288, 4, 1114115, 524288, 4, 1114116, 524288, 4, 1114117, 524288, 4, 1114118, 524288, 4, 1114119, 589824, 4, 1179655, 589824, 5, 1245191, 589824, 5, 1310727, 589824, 5, 1376263, 589824, 5, 1441799, 589824, 5, 1179648, 458752, 5, 1245184, 458752, 5, 1310720, 458752, 5, 1376256, 458752, 5, 1441792, 458752, 5, 1179649, 524288, 5, 1245185, 524288, 5, 1310721, 524288, 5, 1376257, 524288, 5, 1441793, 524288, 5, 1179650, 524288, 5, 1245186, 524288, 5, 1310722, 524288, 5, 1376258, 524288, 5, 1441794, 524288, 5, 1179651, 524288, 5, 1245187, 524288, 5, 1310723, 524288, 5, 1376259, 524288, 5, 1441795, 524288, 5, 1179652, 524288, 5, 1245188, 524288, 5, 1310724, 524288, 5, 1376260, 524288, 5, 1441796, 524288, 5, 1179653, 524288, 5, 1245189, 524288, 5, 1310725, 524288, 5, 1376261, 524288, 5, 1441797, 524288, 5, 1179654, 524288, 5, 1245190, 524288, 5, 1310726, 524288, 5, 1376262, 524288, 5, 1441798, 524288, 5, 1441801, 327680, 5, 1441802, 327680, 5, 1441803, 327680, 5, 1441804, 327680, 5, 1441805, 327680, 5, 1441806, 327680, 5, 1441807, 327680, 5, 1441808, 327680, 5, 1441809, 327680, 5, 1441810, 327680, 5, 1441811, 327680, 5, 1441812, 327680, 5, 1441813, 327680, 5, 1441814, 327680, 5, 1441815, 393216, 5, 1441816, 458752, 5, 1376280, 458752, 4, 1310746, 458752, 4, 1310747, 589824, 4, 1376281, 524288, 4, 1441817, 524288, 5, 1441818, 524288, 5, 1376282, 524288, 5, 1376283, 589824, 5, 1441819, 589824, 5, 1179679, 458752, 5, 1245215, 458752, 6, 917536, 589824, 4, 983072, 589824, 6, 1114144, 524288, 4, 1179680, 524288, 5, 1245216, 524288, 6, 1114145, 589824, 4, 1179681, 589824, 5, 1245217, 589824, 6, 1114146, 458752, 5, 1179682, 458752, 6, 1048611, 524288, 4, 1114147, 524288, 5, 1179683, 524288, 6, 1048612, 589824, 4, 1114148, 589824, 5, 1179684, 589824, 6, 917535, 458752, 4, 983071, 458752, 6, 1114143, 458752, 4, 1048610, 458752, 4, 1441800, 262144, 5, 1245212, 458752, 4, 1310748, 458752, 5, 1245213, 524288, 4, 1310749, 524288, 5, 1245214, 589824, 4, 1310750, 589824, 5, 1376284, 458752, 6, 1376285, 524288, 6, 1376286, 589824, 6, 131072, 458752, 6, 131073, 524288, 6, 131074, 524288, 6, 131075, 524288, 6, 131076, 524288, 6, 131077, 524288, 6, 131078, 524288, 6, 131079, 524288, 6, 131080, 524288, 6, 131081, 524288, 6, 131082, 524288, 6, 131083, 524288, 6, 131084, 524288, 6, 131085, 524288, 6, 131086, 524288, 6, 131087, 524288, 6, 131088, 524288, 6, 131089, 524288, 6, 131090, 524288, 6, 131091, 524288, 6, 131092, 524288, 6, 131093, 524288, 6, 131094, 524288, 6, 131095, 524288, 6, 131096, 524288, 6, 131097, 524288, 6, 131098, 524288, 6, 131099, 524288, 6, 131100, 524288, 6, 131101, 524288, 6, 131102, 524288, 6, 131103, 524288, 6, 131104, 524288, 6, 131105, 524288, 6, 131106, 524288, 6, 131107, 524288, 6, 131108, 524288, 6, 65536, 458752, 5, 0, 458752, 5, 1, 524288, 5, 65537, 524288, 5, 2, 524288, 5, 65538, 524288, 5, 3, 524288, 5, 65539, 524288, 5, 4, 524288, 5, 65540, 524288, 5, 5, 524288, 5, 65541, 524288, 5, 6, 524288, 5, 65542, 524288, 5, 7, 524288, 5, 65543, 524288, 5, 8, 524288, 5, 65544, 524288, 5, 9, 524288, 5, 65545, 524288, 5, 10, 524288, 5, 65546, 524288, 5, 11, 524288, 5, 65547, 524288, 5, 12, 524288, 5, 65548, 524288, 5, 13, 524288, 5, 65549, 524288, 5, 14, 524288, 5, 65550, 524288, 5, 15, 524288, 5, 65551, 524288, 5, 16, 524288, 5, 65552, 524288, 5, 17, 524288, 5, 65553, 524288, 5, 18, 524288, 5, 65554, 524288, 5, 19, 524288, 5, 65555, 524288, 5, 20, 524288, 5, 65556, 524288, 5, 21, 524288, 5, 65557, 524288, 5, 22, 524288, 5, 65558, 524288, 5, 23, 524288, 5, 65559, 524288, 5, 24, 524288, 5, 65560, 524288, 5, 25, 524288, 5, 65561, 524288, 5, 26, 524288, 5, 65562, 524288, 5, 27, 524288, 5, 65563, 524288, 5, 28, 524288, 5, 65564, 524288, 5, 29, 524288, 5, 65565, 524288, 5, 30, 524288, 5, 65566, 524288, 5, 31, 524288, 5, 65567, 524288, 5, 32, 524288, 5, 65568, 524288, 5, 33, 524288, 5, 65569, 524288, 5, 34, 524288, 5, 65570, 524288, 5, 35, 524288, 5, 65571, 524288, 5, 36, 524288, 5, 65572, 524288, 5, 38, 524288, 5, 65574, 524288, 5, 131110, 524288, 6, 39, 589824, 5, 65575, 589824, 5, 131111, 589824, 6, 37, 524288, 5, 65573, 524288, 5, 131109, 524288, 6, 196612, 1245184, 0, 262148, 1245184, 0, 327684, 1245184, 0, 393220, 1245184, 1, 196629, 1245184, 0, 262165, 1245184, 0, 327701, 1245184, 0, 393237, 1245184, 0, 458773, 1245184, 0, 524309, 1245184, 0, 589845, 1245184, 1, 196617, 1179648, 65537, 196619, 1179648, 65537, 196625, 1179648, 65537, 196633, 1179648, 65537, 196642, 1179648, 65537, 196645, 1179648, 65537, 1048578, 917504, 2, 1179678, 1048576, 1, 851999, 1114112, 0, 1048583, 1114112, 1)

[node name="RedTrap" type="TileMap" parent="Map" groups=["red", "trap"]]
tile_set = ExtResource("4_d8f6u")
format = 2
layer_0/tile_data = PackedInt32Array(1245211, 196608, 131081, 1245210, 196608, 131081, 1310745, 196608, 262153, 851991, 196608, 131081, 983075, 196608, 131081, 1310746, 524288, 5, 1310747, 589824, 5, 1179686, 196608, 131081, 1179685, 196608, 131081)

[node name="RedTerrain" type="TileMap" parent="Map" groups=["red"]]
tile_set = ExtResource("4_d8f6u")
format = 2
layer_0/tile_data = PackedInt32Array(917528, 327680, 131076, 917527, 327680, 131076, 1245222, 1048576, 131091, 1245221, 917504, 131091)

[node name="BlueTerrain" type="TileMap" parent="Map" groups=["blue"]]
tile_set = ExtResource("4_d8f6u")
format = 2
layer_0/tile_data = PackedInt32Array(851985, 917504, 65553, 851986, 983040, 65553, 851987, 1048576, 65553, 917521, 917504, 65555, 917522, 983040, 65555, 917523, 1048576, 65555)

[node name="BlueTrap" type="TileMap" parent="Map" groups=["blue", "trap"]]
tile_set = ExtResource("4_d8f6u")
format = 2
layer_0/tile_data = PackedInt32Array(1376264, 196608, 65545, 1376270, 196608, 65545, 1376271, 196608, 65545, 1376272, 196608, 65545, 1376269, 196608, 65545, 1376279, 196608, 65545, 1376278, 196608, 65545, 1376277, 196608, 65545)

[node name="Key" type="Node2D" parent="Map" groups=["red"]]
position = Vector2(582, 94)

[node name="Area2D" type="Area2D" parent="Map/Key" groups=["key"]]
collision_layer = 32

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/Key/Area2D"]
shape = SubResource("RectangleShape2D_eh0eq")
debug_color = Color(0.317647, 0.619608, 0.27451, 0.419608)

[node name="KeySprite" type="Sprite2D" parent="Map/Key"]
modulate = Color(1, 0.329412, 0.329412, 1)
texture = ExtResource("5_163c0")

[node name="Door" type="Node2D" parent="Map"]
position = Vector2(18, 265)

[node name="Area2D" type="Area2D" parent="Map/Door" groups=["door"]]
collision_layer = 64

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/Door/Area2D"]
shape = SubResource("RectangleShape2D_pw2v7")
debug_color = Color(0.686275, 0.494118, 0.219608, 0.419608)

[node name="DoorSprite" type="AnimatedSprite2D" parent="Map/Door"]
sprite_frames = ExtResource("6_gwvjs")

[node name="BlueSwitch" type="Node2D" parent="Map" groups=["red"]]
position = Vector2(144, 342)

[node name="Sprite2D" type="Sprite2D" parent="Map/BlueSwitch"]
modulate = Color(1, 0.329412, 0.329412, 1)
texture = ExtResource("7_hnhjq")

[node name="BlueSwitch" type="Area2D" parent="Map/BlueSwitch" groups=["blue_switch"]]
collision_layer = 128

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/BlueSwitch/BlueSwitch"]
shape = SubResource("RectangleShape2D_euvql")
debug_color = Color(0.784314, 0.431373, 0.0823529, 0.419608)

[node name="RedSwitch" type="Node2D" parent="Map"]
position = Vector2(425, 186)

[node name="Sprite2D" type="Sprite2D" parent="Map/RedSwitch"]
modulate = Color(0.380392, 0.4, 1, 1)
texture = ExtResource("7_hnhjq")

[node name="RedSwitch" type="Area2D" parent="Map/RedSwitch"]
collision_layer = 256

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/RedSwitch/RedSwitch"]
shape = SubResource("RectangleShape2D_euvql")
debug_color = Color(0.784314, 0.431373, 0.0823529, 0.419608)

[node name="BackgroundColor" type="Node2D" parent="Map"]
z_index = -1
script = ExtResource("8_v4sxp")

[node name="MPS" type="Node" parent="Map"]

[node name="First" type="Node2D" parent="Map/MPS"]
position = Vector2(-9, 217)

[node name="AnimatableBody2D" type="AnimatableBody2D" parent="Map/MPS/First" node_paths=PackedStringArray("init", "end")]
position = Vector2(223, -40)
collision_layer = 2
script = ExtResource("9_mb6ax")
init = NodePath("../MPSInit")
end = NodePath("../MPSEnd")
duration = 7.0

[node name="Platform" type="TileMap" parent="Map/MPS/First/AnimatableBody2D"]
tile_set = ExtResource("4_d8f6u")
format = 2
layer_0/tile_data = PackedInt32Array(1, 327680, 3)

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/MPS/First/AnimatableBody2D"]
position = Vector2(24, 3.5)
shape = SubResource("RectangleShape2D_0jk3o")

[node name="MPSInit" type="Marker2D" parent="Map/MPS/First"]
position = Vector2(223, -40)

[node name="MPSEnd" type="Marker2D" parent="Map/MPS/First"]
position = Vector2(591, -106)

[node name="LeftWall" type="StaticBody2D" parent="Map"]
position = Vector2(-8, 362)
collision_layer = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/LeftWall"]
position = Vector2(0, -174.5)
shape = SubResource("RectangleShape2D_2ljfn")

[node name="RightWall" type="StaticBody2D" parent="Map"]
position = Vector2(631, 362)
collision_layer = 2

[node name="CollisionShape2D" type="CollisionShape2D" parent="Map/RightWall"]
position = Vector2(0, -174.5)
shape = SubResource("RectangleShape2D_rwov1")

[node name="NextSceneTimer" type="Timer" parent="."]
wait_time = 2.0
one_shot = true

[connection signal="animation_finished" from="CharacterBody2D/AnimatedSprite2D" to="CharacterBody2D" method="_on_animated_sprite_2d_animation_finished"]
[connection signal="body_entered" from="CharacterBody2D/Foot" to="CharacterBody2D" method="_on_area_2d_body_entered"]
[connection signal="area_entered" from="CharacterBody2D/Pick" to="CharacterBody2D" method="_on_pick_area_entered"]
[connection signal="body_entered" from="CharacterBody2D/Body" to="CharacterBody2D" method="_on_body_body_entered"]
[connection signal="timeout" from="CharacterBody2D/RespawnTimer" to="CharacterBody2D" method="_on_respawn_timer_timeout"]
[connection signal="area_entered" from="Map/Door/Area2D" to="CharacterBody2D" method="_on_area_2d_area_entered"]
[connection signal="area_entered" from="Map/BlueSwitch/BlueSwitch" to="CharacterBody2D" method="_on_blue_switch_area_entered"]
[connection signal="area_exited" from="Map/BlueSwitch/BlueSwitch" to="CharacterBody2D" method="_on_blue_switch_area_exited"]
[connection signal="area_entered" from="Map/RedSwitch/RedSwitch" to="CharacterBody2D" method="_on_red_switch_area_entered"]
[connection signal="area_exited" from="Map/RedSwitch/RedSwitch" to="CharacterBody2D" method="_on_red_switch_area_exited"]
[connection signal="timeout" from="NextSceneTimer" to="." method="_on_next_scene_timer_timeout"]
